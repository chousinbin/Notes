# 计算机图形学

> 上机：
>
> 第 3 - 10 周
>
> 周五 A306

## survey

computer graphics: a computer is used to create a picture（图形）

#### 图形

- 本质：矢量
- 存储：程序
- 放大：不失真
- 显示：需要扫描转换

#### 图像

- 本质：标量
- 存储：二维矩阵
- 放大：失真
- 显示：直接显示

#### history

- 50s CRT显示器
- 60s Bezier曲线
- 70s 消隐算法、光照模型、颜色模型
- 90s mid
  - DOS -> Windows
  - Web / www / HTTP
  - Java

## 02x00 Overview of graphics system

### video display device

CRT: Cathode - Ray Tube

redraw the picture repeatedly

#### refresh rate

#### resolution 分辨率

设备分辨率

图像分辨率

像素分辨率

模拟信号：图像连续

数字信号：离散

熵：描述信息中重要信息的量

## 03x00 

#### scan - line algorithms

#### line - draw algorithms

two endpoint

<img src="https://cdn.jsdelivr.net/gh/chousinbin/Image/202403121847821.jpeg" alt="IMG_4462" style="zoom: 25%;" />

#### DDA algorithm

按跨度大轴采样，采样像素更多



$$
0 < m < 1\\x = 1\\y_{k+1}=y_k+m\\x_{k+1} = x_k + 1

\\\\m > 1\\y = 1\\x_{k+1}=x_k+\frac{1}{m}\\y_{k+1}=y_k+1
$$

#### Brenham

$$
if\ p_k\ <\ 0\ the\ pixel\ (x_{k+1},\ y_k)\ and\ p_{k+1} =\ p_k\ +\ 2\Delta y\\
else\ the\ pixel\ (x_{k+1},\ y_{k+1})\ and\ p_{k+1}\ =\ p_k\ +\ 2\Delta y\ -\ 2\Delta x\\
first\ parameter:\ p_0\ =\ 2\Delta y\ -\ \Delta x
$$

## 3.9 Circle - generating Algorithms

$$
x_{k+1}=x_k+1\\
P_0 = 1 - r\\
if\ P_k < 0:\\
pixel(x_k+1, y_k),\ P_{k+1}=P_k + 2x_{k+1}+1\\
else:\\
pixel(x_k+1, y_k-1),\ P_{k+1} = P_k+2x_{k+1}-2y_{k+1}+1\\
where\ y_{k+1}=y_k-1
$$

最后一个点到斜轴 $(x = y)$ 时，总点数 = $8 * n + 8$，未到斜轴时 $(x != y)$ ，总点数 = $8 * n + 4$



# 5 Geometrics Transformation

## 5.1 矩阵

### 旋转

$$
旋转\ \theta\ 逆时针\ \theta\ 为正\\
x'=xcos\theta - ysin\theta\\
y'=xsin\theta - ycos\theta\\
$$

### 缩放

$$
x'=s_x·x\\
y'=s_y·y\\
$$

## 5.2 homogeneous coordinates 齐次坐标

 二维矩阵用三维坐标表示，把平移由加法换成乘法。

### 二维缩放

#### 绕原点缩放


$$
\begin{bmatrix}
s_x & 0 & 0 \\
0 & s_y & 0 \\
0 & 0 & 1 \\
\end{bmatrix}
·
\begin{bmatrix}
x_0 \\
y_0 \\
1 \\
\end{bmatrix}
$$

#### 绕定点缩放

1. 基准点平移回原点
2. 缩放
3. 从原点平移回基准点

$$
\begin{bmatrix}
1 & 0 & x_f\\
0 & 1 & y_f\\
0 & 0 & 1\\
\end{bmatrix}
\begin{bmatrix}
s_x & 0 & 0 \\
0 & s_y & 0 \\
0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
1 & 0 & -x_f\\
0 & 1 & -y_f\\
0 & 0 & 1\\
\end{bmatrix}
·
\begin{bmatrix}
x_0 \\
y_0 \\
1 \\
\end{bmatrix}
$$



### 二维旋转

#### 绕原点旋转

顺时针绕原点旋转， $\theta$ 为负值，反之为正值。
$$
\begin{bmatrix}
cos\theta & -sin\theta & 0\\
sin\theta & cos\theta & 0\\
0 & 0 & 1
\end{bmatrix}
·
\begin{bmatrix}
x \\
y \\
1 \\
\end{bmatrix}
$$

#### 绕定点旋转

1. 基准点平移回原点
2. 旋转
3. 从原点平移回基准点

$$
\begin{bmatrix}
1 & 0 & x_t\\
0 & 1 & y_t\\
0 & 0 & 1\\
\end{bmatrix}

\begin{bmatrix}
cos\theta & -sin\theta & 0\\
sin\theta & cos\theta & 0\\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 & -x_t\\
0 & 1 & -y_t\\
0 & 0 & 1\\
\end{bmatrix}
·
\begin{bmatrix}
x_0 \\
y_0 \\
1 \\
\end{bmatrix}
$$



### 二维平移

$$
\begin{bmatrix}
1 & 0 & t_x \\
0 & 1 & t_y \\
0 & 0 & 1 \\
\end{bmatrix}
·
\begin{bmatrix}
x_0 \\
y_0 \\
1 \\
\end{bmatrix}
$$

### 例题

P(3,1) with clockwise $\theta=45$ to $P_1$ then translate $P_1$ with $t_x=3\ t_y=4$, scale $P_2$ with $S_x=2\ s_y=3$ to $P''$
$$
P_3 = 
\begin{bmatrix}
x' \\
y' \\
1
\end{bmatrix}
=
\begin{bmatrix}
2 & 0 & 0\\
0 & 3 & 0\\
0 & 0 & 1\\
\end{bmatrix}

\begin{bmatrix}
1 & 0 & 3\\
0 & 1 & 4\\
0 & 0 & 1\\
\end{bmatrix}

\begin{bmatrix}
\frac{\sqrt{2}}{2} & \frac{\sqrt{2}}{2} & 0\\
-\frac{\sqrt{2}}{2} & \frac{\sqrt{2}}{2} & 0\\
0 & 0 & 1\\
\end{bmatrix}

\begin{bmatrix}
3\\
1\\
1\\
\end{bmatrix}
=
\begin{bmatrix}
6 + 4 \sqrt{2}\\
12 - 3 \sqrt{2}\\
1\\
\end{bmatrix}
\\ （从后向前构造）
\\ so\ P''(6 + 4 \sqrt{2},\ 12 - 3 \sqrt{2})
$$

### 对称

#### 关于 x 轴对称

$$
\begin{bmatrix}
x' \\
y'\\
1
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0\\
0 & -1 & 0\\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x\\y\\1
\end{bmatrix}
$$

#### y

$$
\begin{bmatrix}
x' \\
y'\\
1
\end{bmatrix}
=
\begin{bmatrix}
-1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x\\y\\1
\end{bmatrix}
$$

#### 原点对称

$$
\begin{bmatrix}
x' \\
y'\\
1
\end{bmatrix}
=
\begin{bmatrix}
-1 & 0 & 0\\
0 & -1 & 0\\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x\\y\\1
\end{bmatrix}
$$

#### y = x

$$
\begin{bmatrix}
x' \\
y'\\
1
\end{bmatrix}
=
\begin{bmatrix}
0 & 1 & 0\\
1 & 0 & 0\\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x\\y\\1
\end{bmatrix}
$$

#### y = -x

$$
\begin{bmatrix}
x' \\
y'\\
1
\end{bmatrix}
=
\begin{bmatrix}
0 & -1 & 0\\
-1 & 0 & 0\\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x\\y\\1
\end{bmatrix}
$$

#### 关于 $y = mx + b$ 对称

1. 平移原线使得过原点；
2. 顺时针旋转，使得与 $x$ 轴重合；
3. 关于 $x$ 轴对称；
4. 逆时针旋转，回到原来角度；
5. 逆平移，回到原来截距。

$$
\begin{bmatrix}
x' \\ y' \\1
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0\\
0 & 1 & b\\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
cos\alpha & -sin\alpha & 0\\
sin\alpha & cos\alpha & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0\\
0 & -1 & 0\\
0 & 0 & 1\\
\end{bmatrix}
\begin{bmatrix}
cos\alpha & sin\alpha & 0\\
-sin\alpha & cos\alpha & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0\\
0 & 1 & -b\\
0 & 0 & 1\\
\end{bmatrix}
\begin{bmatrix}
x\\y\\1
\end{bmatrix}
$$

### shear 错切

#### 关于 x

$y$ 不变，$x$ 随 $y$ 增大而增大。
$$
\begin{bmatrix}
x' \\ y' \\1
\end{bmatrix}
=
\begin{bmatrix}
1 & sh_x & 0\\
0 & 1 & 0\\
0 & 0 &1\\
\end{bmatrix}
\begin{bmatrix}
x\\y\\1
\end{bmatrix}
$$

#### 关于 y

$x$ 不变，$y$ 随 $x$ 增大而增大。
$$
\begin{bmatrix}
x' \\ y' \\1
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0\\
sh_y & 1 & 0\\
0 & 0 &1\\
\end{bmatrix}
\begin{bmatrix}
x\\y\\1
\end{bmatrix}
$$

# 3 - d transformation

### 三维平移

$$
\begin{bmatrix} x' \\ y' \\ z' \\ 1 \end{bmatrix}
=
\begin{bmatrix} 1 & 0 & 0 & t_x \\ 0 & 1 & 0 & t_y \\ 0 & 0 & 1 & t_z \\ 0 & 0 & 0 & 1 \end{bmatrix}
\begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
$$

### 三维旋转

#### 绕 $z$ 轴

$$
\begin{bmatrix} x' \\ y' \\ z' \\ 1 \end{bmatrix}
=
\begin{bmatrix} cos\theta & -sin\theta & 0 & 0 \\ sin\theta & cos\theta & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}
\begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
$$

#### 绕 $x$ 轴

$$
\begin{bmatrix} x' \\ y' \\ z' \\ 1 \end{bmatrix}
=
\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & cos\theta & -sin\theta & 0 \\ 0 & sin\theta & cos\theta & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}
\begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
$$

#### 绕 $y$ 轴

$$
\begin{bmatrix} x' \\ y' \\ z' \\ 1 \end{bmatrix}
=
\begin{bmatrix} 
cos\theta & 0 & sin\theta & 0 \\
0 & 1 & 0 & 0 \\
-sin\theta & 0 & cos\theta & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
\begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
$$

#### ~~关于 线 旋转~~

1. 把线平移，使得过原点
2. 旋转线，使得过某个平面
3. 再旋转使得过轴
4. 点根据轴旋转
5. 逆旋转回平面
6. 逆旋转回原点
7. 逆平移回原线

### 三维缩放

#### 关于原点

$$
\begin{bmatrix} x' \\ y' \\ z' \\ 1 \end{bmatrix}
=
\begin{bmatrix} s_x & 0 & 0 & 0 \\ 0 & s_y & 0 & 0 \\ 0 & 0 & s_z & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}
\begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
$$

#### 关于 $(x_f,y_f,z_f)$

$$
\begin{bmatrix} x' \\ y' \\ z' \\ 1 \end{bmatrix}
=
\begin{bmatrix} s_x & 0 & 0 & (1-s_x)x_f \\ 0 & s_y & 0 & (1-s_y)y_f \\ 0 & 0 & s_z & (1-s_z)z_f \\ 0 & 0 & 0 & 1 \end{bmatrix}
\begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
$$

